Name: xs-opam-src
Version: 3.9.1
Release: 1.1.xcp%{?dist}
Summary: Opam repository
License: Various
URL: https://github.com/xapi-project/xs-opam/archive/3.9.1/xs-opam-3.9.1.tar.gz
AutoReqProv: no

# If you need to "pin" a package during development to follow the
# HEAD of a repository rather than using the fixed version listed
# below, DON'T change anything here. Take a look at xs-opam-repo.rpm
# for how to do it.

Source000: https://repo.citrite.net/ctx-local-contrib/xs-opam/xs-opam-3.9.1.tar.gz
Source001: https://repo.citrite.net/ctx-local-contrib/xs-opam/alcotest-0.8.1.tbz
Source002: https://repo.citrite.net/ctx-local-contrib/xs-opam/angstrom-0.8.0.tar.gz
Source003: https://repo.citrite.net/ctx-local-contrib/xs-opam/asn1-combinators-0.2.0.tbz
Source004: https://repo.citrite.net/ctx-local-contrib/xs-opam/astring-0.8.3.tbz
Source005: https://repo.citrite.net/ctx-local-contrib/xs-opam/async-v0.10.0.tar.gz
Source006: https://repo.citrite.net/ctx-local-contrib/xs-opam/async_extra-v0.10.0.tar.gz
Source007: https://repo.citrite.net/ctx-local-contrib/xs-opam/async_find-v0.10.0.tar.gz
Source008: https://repo.citrite.net/ctx-local-contrib/xs-opam/async_inotify-v0.10.0.tar.gz
Source009: https://repo.citrite.net/ctx-local-contrib/xs-opam/async_kernel-v0.10.0.tar.gz
Source010: https://repo.citrite.net/ctx-local-contrib/xs-opam/async_rpc_kernel-v0.10.0.tar.gz
Source011: https://repo.citrite.net/ctx-local-contrib/xs-opam/async_unix-v0.10.0.tar.gz
Source012: https://repo.citrite.net/ctx-local-contrib/xs-opam/base-v0.10.0.tar.gz
Source013: https://repo.citrite.net/ctx-local-contrib/xs-opam/base64-2.2.0.tbz
Source014: https://repo.citrite.net/ctx-local-contrib/xs-opam/bin_prot-v0.10.0.tar.gz
Source015: https://repo.citrite.net/ctx-local-contrib/xs-opam/biniou-v1.2.0.tar.gz
Source016: https://repo.citrite.net/ctx-local-contrib/xs-opam/bisect_ppx-1.3.2.tar.gz
Source017: https://repo.citrite.net/ctx-local-contrib/xs-opam/camlp4-4.04+1.tar.gz
Source018: https://repo.citrite.net/ctx-local-contrib/xs-opam/cmdliner-1.0.2.tbz
Source019: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-cohttp-v1.0.2.tar.gz
Source020: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-conduit-v1.0.3.tar.gz
Source021: https://repo.citrite.net/ctx-local-contrib/xs-opam/configurator-v0.10.0.tar.gz
Source022: https://repo.citrite.net/ctx-local-contrib/xs-opam/core-v0.10.0.tar.gz
Source023: https://repo.citrite.net/ctx-local-contrib/xs-opam/core_kernel-v0.10.0.tar.gz
Source024: https://repo.citrite.net/ctx-local-contrib/xs-opam/cow-2.2.0.tbz
Source025: https://repo.citrite.net/ctx-local-contrib/xs-opam/cppo-v1.6.4.tar.gz
Source026: https://repo.citrite.net/ctx-local-contrib/xs-opam/cppo-v1.6.0.tar.gz
Source027: https://repo.citrite.net/ctx-local-contrib/xs-opam/cpuid-0.1.1.tbz
Source028: https://repo.citrite.net/ctx-local-contrib/xs-opam/cstruct-3.2.1.tbz
Source029: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-ctypes-0.13.1.tar.gz
Source030: https://repo.citrite.net/ctx-local-contrib/xs-opam/opam-depext-full-1.0.5.tbz
Source031: https://repo.citrite.net/ctx-local-contrib/xs-opam/duration-0.1.1.tbz
Source032: https://repo.citrite.net/ctx-local-contrib/xs-opam/easy-format-v1.3.1.tar.gz
Source033: https://repo.citrite.net/ctx-local-contrib/xs-opam/ezjsonm-0.5.0.tbz
Source034: https://repo.citrite.net/ctx-local-contrib/xs-opam/fieldslib-v0.10.0.tar.gz
Source035: https://repo.citrite.net/ctx-local-contrib/xs-opam/fmt-0.8.5.tbz
Source036: https://repo.citrite.net/ctx-local-contrib/xs-opam/hex-1.2.0.tbz
Source037: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-inotify-v2.3.tar.gz
Source038: https://repo.citrite.net/ctx-local-contrib/xs-opam/integers-0.2.2.tbz
Source039: https://repo.citrite.net/ctx-local-contrib/xs-opam/io-page-2.0.1.tbz
Source040: https://repo.citrite.net/ctx-local-contrib/xs-opam/ipaddr-2.8.0.tbz
Source041: https://repo.citrite.net/ctx-local-contrib/xs-opam/jane-street-headers-v0.10.0.tar.gz
Source042: https://repo.citrite.net/ctx-local-contrib/xs-opam/jbuilder-1.0.beta19.1.tbz
Source043: https://repo.citrite.net/ctx-local-contrib/xs-opam/jsonm-1.0.1.tbz
Source044: https://repo.citrite.net/ctx-local-contrib/xs-opam/logs-0.6.2.tbz
Source045: https://repo.citrite.net/ctx-local-contrib/xs-opam/lwt-3.3.0.tar.gz
Source046: https://repo.citrite.net/ctx-local-contrib/xs-opam/lwt-3.2.0.tar.gz
Source047: https://repo.citrite.net/ctx-local-contrib/xs-opam/lwt_ssl-1.1.2.tar.gz
Source048: https://repo.citrite.net/ctx-local-contrib/xs-opam/magic-mime-1.0.1.tbz
Source049: https://repo.citrite.net/ctx-local-contrib/xs-opam/archive.tar.gz
Source050: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-block-1.1.0.tbz
Source051: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-block-unix-2.9.0.tbz
Source052: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-channel-3.1.0.tbz
Source053: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-clock-1.3.0.tbz
Source054: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-clock-1.4.0.tbz
Source055: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-console-2.3.5.tbz
Source056: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-device-1.1.0.tbz
Source057: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-flow-1.4.0.tbz
Source058: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-flow-1.3.0.tbz
Source059: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-fs-1.1.1.tbz
Source060: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-kv-1.1.0.tbz
Source061: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-kv-1.1.1.tbz
Source062: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-net-1.1.0.tbz
Source063: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-net-1.1.1.tbz
Source064: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-profile-v0.7.0.tar.gz
Source065: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-protocols-1.3.0.tbz
Source066: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-random-1.1.0.tbz
Source067: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-stack-1.2.0.tbz
Source068: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-time-1.1.0.tbz
Source069: https://repo.citrite.net/ctx-local-contrib/xs-opam/mirage-3.0.7.tbz
Source070: https://repo.citrite.net/ctx-local-contrib/xs-opam/mtime-1.1.0.tbz
Source071: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-mustache-v3.0.0.tar.gz
Source072: https://repo.citrite.net/ctx-local-contrib/xs-opam/nocrypto-0.5.4.tbz
Source073: https://repo.citrite.net/ctx-local-contrib/xs-opam/oasis-0.4.10.tar.gz
Source074: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-compiler-libs-v0.10.0.tar.gz
Source075: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-migrate-parsetree-1.0.9.tbz
Source076: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocamlbuild-0.12.0.tar.gz
Source077: https://repo.citrite.net/ctx-local-contrib/xs-opam/findlib-1.7.3.tar.gz
Source078: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocamlify-0.0.1.tar.gz
Source079: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocamlmod-0.0.9.tar.gz
Source080: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocb-stubblr-0.1.1.tbz
Source081: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocplib-endian-1.0.tar.gz
Source082: https://repo.citrite.net/ctx-local-contrib/xs-opam/octavius-v1.2.0.tar.gz
Source083: https://repo.citrite.net/ctx-local-contrib/xs-opam/omd-1.3.1.tar.gz
Source084: https://repo.citrite.net/ctx-local-contrib/xs-opam/ounit-2.0.7.tar.gz
Source085: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_assert-v0.10.0.tar.gz
Source086: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_ast-v0.10.0.tar.gz
Source087: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_base-v0.10.0.tar.gz
Source088: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_bench-v0.10.0.tar.gz
Source089: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_bin_prot-v0.10.0.tar.gz
Source090: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_compare-v0.10.0.tar.gz
Source091: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_core-v0.10.0.tar.gz
Source092: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_custom_printf-v0.10.0.tar.gz
Source093: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_derivers-1.0.tar.gz
Source094: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_deriving-v4.2.1.tar.gz
Source095: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_driver-v0.10.4.tar.gz
Source096: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_enumerate-v0.10.0.tar.gz
Source097: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_expect-v0.10.1.tar.gz
Source098: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_fail-v0.10.0.tar.gz
Source099: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_fields_conv-v0.10.0.tar.gz
Source100: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_hash-v0.10.0.tar.gz
Source101: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_here-v0.10.0.tar.gz
Source102: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_inline_test-v0.10.1.tar.gz
Source103: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_jane-v0.10.0.tar.gz
Source104: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_js_style-v0.10.0.tar.gz
Source105: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_let-v0.10.0.tar.gz
Source106: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_metaquot-v0.10.0.tar.gz
Source107: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_optcomp-v0.10.0.tar.gz
Source108: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_optional-v0.10.0.tar.gz
Source109: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_pipebang-v0.10.0.tar.gz
Source110: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_sexp_conv-v0.10.0.tar.gz
Source111: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_sexp_message-v0.10.0.tar.gz
Source112: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_sexp_value-v0.10.0.tar.gz
Source113: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_tools-5.0+4.04.tar.gz
Source114: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_tools_versioned-5.1.tar.gz
Source115: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_traverse-v0.10.0.tar.gz
Source116: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_traverse_builtins-v0.10.0.tar.gz
Source117: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_type_conv-v0.10.0.tar.gz
Source118: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_typerep_conv-v0.10.0.tar.gz
Source119: https://repo.citrite.net/ctx-local-contrib/xs-opam/ppx_variants_conv-v0.10.0.tar.gz
Source120: https://repo.citrite.net/ctx-local-contrib/xs-opam/protocol_version_header-v0.10.0.tar.gz
Source121: https://repo.citrite.net/ctx-local-contrib/xs-opam/ptime-0.8.3.tbz
Source122: https://repo.citrite.net/ctx-local-contrib/xs-opam/re-1.7.3.tbz
Source123: https://repo.citrite.net/ctx-local-contrib/xs-opam/result-1.3.tbz
Source124: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-rpc-v3.2.0.tar.gz
Source125: https://repo.citrite.net/ctx-local-contrib/xs-opam/rresult-0.5.0.tbz
Source126: https://repo.citrite.net/ctx-local-contrib/xs-opam/sexplib-v0.10.0.tar.gz
Source127: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-sha-v1.10.tar.gz
Source128: https://repo.citrite.net/ctx-local-contrib/xs-opam/shared-block-ring-v2.4.0.tar.gz
Source129: https://repo.citrite.net/ctx-local-contrib/xs-opam/spawn-v0.10.1.tar.gz
Source130: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-ssl-0.5.5.tar.gz
Source131: https://repo.citrite.net/ctx-local-contrib/xs-opam/stdio-v0.10.0.tar.gz
Source132: https://repo.citrite.net/ctx-local-contrib/xs-opam/stringext-1.5.0.tar.gz
Source133: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-systemd-1.2.tar.gz
Source134: https://repo.citrite.net/ctx-local-contrib/xs-opam/tar-0.9.0.tbz
Source135: https://repo.citrite.net/ctx-local-contrib/xs-opam/topkg-0.9.1.tbz
Source136: https://repo.citrite.net/ctx-local-contrib/xs-opam/type_conv-113.00.02.tar.gz
Source137: https://repo.citrite.net/ctx-local-contrib/xs-opam/typerep-v0.10.0.tar.gz
Source138: https://repo.citrite.net/ctx-local-contrib/xs-opam/uchar-0.0.2.tbz
Source139: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-unix-errno-0.5.2.tar.gz
Source140: https://repo.citrite.net/ctx-local-contrib/xs-opam/uri-1.9.6.tbz
Source141: https://repo.citrite.net/ctx-local-contrib/xs-opam/uuidm-0.9.6.tbz
Source142: https://repo.citrite.net/ctx-local-contrib/xs-opam/uutf-1.0.1.tbz
Source143: https://repo.citrite.net/ctx-local-contrib/xs-opam/variantslib-v0.10.0.tar.gz
Source144: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-vhd-v0.9.2.tar.gz
Source145: https://repo.citrite.net/ctx-local-contrib/xs-opam/x509-0.6.1.tbz
Source146: https://repo.citrite.net/ctx-local-contrib/xs-opam/xen-gnt-3.0.1.tbz
Source147: https://repo.citrite.net/ctx-local-contrib/xs-opam/xenstore-2.0.0.tbz
Source148: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-xenstore-clients-v1.0.0.tar.gz
Source149: https://repo.citrite.net/ctx-local-contrib/xs-opam/xmlm-1.3.0.tbz
Source150: https://repo.citrite.net/ctx-local-contrib/xs-opam/yojson-v1.4.1.tar.gz
Source151: https://repo.citrite.net/ctx-local-contrib/xs-opam/Zarith-release-1.7.tar.gz
Source152: https://repo.citrite.net/ctx-local-contrib/xs-opam/cdrom-v0.9.3.tar.gz
Source153: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-crc-2.0.0.tar.gz
Source154: https://repo.citrite.net/ctx-local-contrib/xs-opam/dlm-0.3.0.tbz
Source155: https://repo.citrite.net/ctx-local-contrib/xs-opam/ezxenstore-v0.2.0.tar.gz
Source156: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-fd-send-recv-v1.0.5.tar.gz
Source157: https://repo.citrite.net/ctx-local-contrib/xs-opam/nbd-v4.0.0+beta1.tar.gz
Source158: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-netlink-v0.3.1.tar.gz
Source159: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-opasswd-v1.3.0.tar.gz
Source160: https://repo.citrite.net/ctx-local-contrib/xs-opam/ocaml-qmp-0.14.0.tar.gz
Source161: https://repo.citrite.net/ctx-local-contrib/xs-opam/xcp-rrd-v1.3.0.tar.gz
Source162: https://repo.citrite.net/ctx-local-contrib/xs-opam/stdext-v4.0.0.tar.gz
Source163: https://repo.citrite.net/ctx-local-contrib/xs-opam/backtrace-v0.5.tar.gz
Source164: https://repo.citrite.net/ctx-local-contrib/xs-opam/xcp-inventory-v1.2.0.tar.gz
Source165: https://repo.citrite.net/ctx-local-contrib/xs-opam/xapi-test-utils-v1.1.0.tar.gz

# XCP-ng patches
Patch1000: ocaml-vhd-0.9.2-fix-importing-large-VDI.backport.patch
Patch1001: ocaml-vhd-0.9.2-fix-string-escaping-in-code-generator.backport.patch
%define ocaml_vhd_version 0.9.2

BuildRequires: opam
BuildRequires: rsync

%description
Opam repository containing all upstream and development libraries
required for building the OCaml components in the XS Toolstack.

%prep
%setup -n xs-opam-3.9.1

# Patch ocaml-vhd
tar xf %{SOURCE144}
pushd ocaml-vhd-%{ocaml_vhd_version}
patch -p1 < %{PATCH1000}
patch -p1 < %{PATCH1001}
popd
mkdir -p build/src
tar -czf build/src/ocaml-vhd-v%{ocaml_vhd_version}.tar.gz ocaml-vhd-%{ocaml_vhd_version}
rm ocaml-vhd-%{ocaml_vhd_version} -rf

rpm_src ()
{
  cd build/src
  test -f $1 || ln -s ../../../../SOURCES/$1 .
  cd ../..
}

# each line links a file from SOURCES into the build tree
rpm_src alcotest-0.8.1.tbz
rpm_src angstrom-0.8.0.tar.gz
rpm_src asn1-combinators-0.2.0.tbz
rpm_src astring-0.8.3.tbz
rpm_src async-v0.10.0.tar.gz
rpm_src async_extra-v0.10.0.tar.gz
rpm_src async_find-v0.10.0.tar.gz
rpm_src async_inotify-v0.10.0.tar.gz
rpm_src async_kernel-v0.10.0.tar.gz
rpm_src async_rpc_kernel-v0.10.0.tar.gz
rpm_src async_unix-v0.10.0.tar.gz
rpm_src base-v0.10.0.tar.gz
rpm_src base64-2.2.0.tbz
rpm_src bin_prot-v0.10.0.tar.gz
rpm_src biniou-v1.2.0.tar.gz
rpm_src bisect_ppx-1.3.2.tar.gz
rpm_src camlp4-4.04+1.tar.gz
rpm_src cmdliner-1.0.2.tbz
rpm_src ocaml-cohttp-v1.0.2.tar.gz
rpm_src ocaml-conduit-v1.0.3.tar.gz
rpm_src configurator-v0.10.0.tar.gz
rpm_src core-v0.10.0.tar.gz
rpm_src core_kernel-v0.10.0.tar.gz
rpm_src cow-2.2.0.tbz
rpm_src cppo-v1.6.4.tar.gz
rpm_src cppo-v1.6.0.tar.gz
rpm_src cpuid-0.1.1.tbz
rpm_src cstruct-3.2.1.tbz
rpm_src ocaml-ctypes-0.13.1.tar.gz
rpm_src opam-depext-full-1.0.5.tbz
rpm_src duration-0.1.1.tbz
rpm_src easy-format-v1.3.1.tar.gz
rpm_src ezjsonm-0.5.0.tbz
rpm_src fieldslib-v0.10.0.tar.gz
rpm_src fmt-0.8.5.tbz
rpm_src hex-1.2.0.tbz
rpm_src ocaml-inotify-v2.3.tar.gz
rpm_src integers-0.2.2.tbz
rpm_src io-page-2.0.1.tbz
rpm_src ipaddr-2.8.0.tbz
rpm_src jane-street-headers-v0.10.0.tar.gz
rpm_src jbuilder-1.0.beta19.1.tbz
rpm_src jsonm-1.0.1.tbz
rpm_src logs-0.6.2.tbz
rpm_src lwt-3.3.0.tar.gz
rpm_src lwt-3.2.0.tar.gz
rpm_src lwt_ssl-1.1.2.tar.gz
rpm_src magic-mime-1.0.1.tbz
rpm_src archive.tar.gz
rpm_src mirage-block-1.1.0.tbz
rpm_src mirage-block-unix-2.9.0.tbz
rpm_src mirage-channel-3.1.0.tbz
rpm_src mirage-clock-1.3.0.tbz
rpm_src mirage-clock-1.4.0.tbz
rpm_src mirage-console-2.3.5.tbz
rpm_src mirage-device-1.1.0.tbz
rpm_src mirage-flow-1.4.0.tbz
rpm_src mirage-flow-1.3.0.tbz
rpm_src mirage-fs-1.1.1.tbz
rpm_src mirage-kv-1.1.0.tbz
rpm_src mirage-kv-1.1.1.tbz
rpm_src mirage-net-1.1.0.tbz
rpm_src mirage-net-1.1.1.tbz
rpm_src mirage-profile-v0.7.0.tar.gz
rpm_src mirage-protocols-1.3.0.tbz
rpm_src mirage-random-1.1.0.tbz
rpm_src mirage-stack-1.2.0.tbz
rpm_src mirage-time-1.1.0.tbz
rpm_src mirage-3.0.7.tbz
rpm_src mtime-1.1.0.tbz
rpm_src ocaml-mustache-v3.0.0.tar.gz
rpm_src nocrypto-0.5.4.tbz
rpm_src oasis-0.4.10.tar.gz
rpm_src ocaml-compiler-libs-v0.10.0.tar.gz
rpm_src ocaml-migrate-parsetree-1.0.9.tbz
rpm_src ocamlbuild-0.12.0.tar.gz
rpm_src findlib-1.7.3.tar.gz
rpm_src ocamlify-0.0.1.tar.gz
rpm_src ocamlmod-0.0.9.tar.gz
rpm_src ocb-stubblr-0.1.1.tbz
rpm_src ocplib-endian-1.0.tar.gz
rpm_src octavius-v1.2.0.tar.gz
rpm_src omd-1.3.1.tar.gz
rpm_src ounit-2.0.7.tar.gz
rpm_src ppx_assert-v0.10.0.tar.gz
rpm_src ppx_ast-v0.10.0.tar.gz
rpm_src ppx_base-v0.10.0.tar.gz
rpm_src ppx_bench-v0.10.0.tar.gz
rpm_src ppx_bin_prot-v0.10.0.tar.gz
rpm_src ppx_compare-v0.10.0.tar.gz
rpm_src ppx_core-v0.10.0.tar.gz
rpm_src ppx_custom_printf-v0.10.0.tar.gz
rpm_src ppx_derivers-1.0.tar.gz
rpm_src ppx_deriving-v4.2.1.tar.gz
rpm_src ppx_driver-v0.10.4.tar.gz
rpm_src ppx_enumerate-v0.10.0.tar.gz
rpm_src ppx_expect-v0.10.1.tar.gz
rpm_src ppx_fail-v0.10.0.tar.gz
rpm_src ppx_fields_conv-v0.10.0.tar.gz
rpm_src ppx_hash-v0.10.0.tar.gz
rpm_src ppx_here-v0.10.0.tar.gz
rpm_src ppx_inline_test-v0.10.1.tar.gz
rpm_src ppx_jane-v0.10.0.tar.gz
rpm_src ppx_js_style-v0.10.0.tar.gz
rpm_src ppx_let-v0.10.0.tar.gz
rpm_src ppx_metaquot-v0.10.0.tar.gz
rpm_src ppx_optcomp-v0.10.0.tar.gz
rpm_src ppx_optional-v0.10.0.tar.gz
rpm_src ppx_pipebang-v0.10.0.tar.gz
rpm_src ppx_sexp_conv-v0.10.0.tar.gz
rpm_src ppx_sexp_message-v0.10.0.tar.gz
rpm_src ppx_sexp_value-v0.10.0.tar.gz
rpm_src ppx_tools-5.0+4.04.tar.gz
rpm_src ppx_tools_versioned-5.1.tar.gz
rpm_src ppx_traverse-v0.10.0.tar.gz
rpm_src ppx_traverse_builtins-v0.10.0.tar.gz
rpm_src ppx_type_conv-v0.10.0.tar.gz
rpm_src ppx_typerep_conv-v0.10.0.tar.gz
rpm_src ppx_variants_conv-v0.10.0.tar.gz
rpm_src protocol_version_header-v0.10.0.tar.gz
rpm_src ptime-0.8.3.tbz
rpm_src re-1.7.3.tbz
rpm_src result-1.3.tbz
rpm_src ocaml-rpc-v3.2.0.tar.gz
rpm_src rresult-0.5.0.tbz
rpm_src sexplib-v0.10.0.tar.gz
rpm_src ocaml-sha-v1.10.tar.gz
rpm_src shared-block-ring-v2.4.0.tar.gz
rpm_src spawn-v0.10.1.tar.gz
rpm_src ocaml-ssl-0.5.5.tar.gz
rpm_src stdio-v0.10.0.tar.gz
rpm_src stringext-1.5.0.tar.gz
rpm_src ocaml-systemd-1.2.tar.gz
rpm_src tar-0.9.0.tbz
rpm_src topkg-0.9.1.tbz
rpm_src type_conv-113.00.02.tar.gz
rpm_src typerep-v0.10.0.tar.gz
rpm_src uchar-0.0.2.tbz
rpm_src ocaml-unix-errno-0.5.2.tar.gz
rpm_src uri-1.9.6.tbz
rpm_src uuidm-0.9.6.tbz
rpm_src uutf-1.0.1.tbz
rpm_src variantslib-v0.10.0.tar.gz
rpm_src ocaml-vhd-v0.9.2.tar.gz
rpm_src x509-0.6.1.tbz
rpm_src xen-gnt-3.0.1.tbz
rpm_src xenstore-2.0.0.tbz
rpm_src ocaml-xenstore-clients-v1.0.0.tar.gz
rpm_src xmlm-1.3.0.tbz
rpm_src yojson-v1.4.1.tar.gz
rpm_src Zarith-release-1.7.tar.gz
rpm_src cdrom-v0.9.3.tar.gz
rpm_src ocaml-crc-2.0.0.tar.gz
rpm_src dlm-0.3.0.tbz
rpm_src ezxenstore-v0.2.0.tar.gz
rpm_src ocaml-fd-send-recv-v1.0.5.tar.gz
rpm_src nbd-v4.0.0+beta1.tar.gz
rpm_src ocaml-netlink-v0.3.1.tar.gz
rpm_src ocaml-opasswd-v1.3.0.tar.gz
rpm_src ocaml-qmp-0.14.0.tar.gz
rpm_src xcp-rrd-v1.3.0.tar.gz
rpm_src stdext-v4.0.0.tar.gz
rpm_src backtrace-v0.5.tar.gz
rpm_src xcp-inventory-v1.2.0.tar.gz
rpm_src xapi-test-utils-v1.1.0.tar.gz

%build
opam_archive ()
{
  echo 'http: "file://'$PWD'/build/src/'$2'"' > "build/packages/$1/url"
}

cp -r packages build
find build/packages -type f -name 'url' -execdir mv '{}' '{}'.off ';'
# each line links an Opam package with its source code
opam_archive 'upstream/alcotest.0.8.1' alcotest-0.8.1.tbz
opam_archive 'upstream/angstrom.0.8.0' angstrom-0.8.0.tar.gz
opam_archive 'upstream/asn1-combinators.0.2.0' asn1-combinators-0.2.0.tbz
opam_archive 'upstream/astring.0.8.3' astring-0.8.3.tbz
opam_archive 'upstream/async.v0.10.0' async-v0.10.0.tar.gz
opam_archive 'upstream/async_extra.v0.10.0' async_extra-v0.10.0.tar.gz
opam_archive 'upstream/async_find.v0.10.0' async_find-v0.10.0.tar.gz
opam_archive 'upstream/async_inotify.v0.10.0' async_inotify-v0.10.0.tar.gz
opam_archive 'upstream/async_kernel.v0.10.0' async_kernel-v0.10.0.tar.gz
opam_archive 'upstream/async_rpc_kernel.v0.10.0' async_rpc_kernel-v0.10.0.tar.gz
opam_archive 'upstream/async_unix.v0.10.0' async_unix-v0.10.0.tar.gz
opam_archive 'upstream/base.v0.10.0' base-v0.10.0.tar.gz
opam_archive 'upstream/base64.2.2.0' base64-2.2.0.tbz
opam_archive 'upstream/bin_prot.v0.10.0' bin_prot-v0.10.0.tar.gz
opam_archive 'upstream/biniou.1.2.0' biniou-v1.2.0.tar.gz
opam_archive 'upstream/bisect_ppx.1.3.2' bisect_ppx-1.3.2.tar.gz
opam_archive 'upstream/camlp4.4.04+1' camlp4-4.04+1.tar.gz
opam_archive 'upstream/cmdliner.1.0.2' cmdliner-1.0.2.tbz
opam_archive 'upstream/cohttp-async.v1.0.2' ocaml-cohttp-v1.0.2.tar.gz
opam_archive 'upstream/cohttp-lwt-unix.v1.0.2' ocaml-cohttp-v1.0.2.tar.gz
opam_archive 'upstream/cohttp-lwt.v1.0.2' ocaml-cohttp-v1.0.2.tar.gz
opam_archive 'upstream/cohttp.v1.0.2' ocaml-cohttp-v1.0.2.tar.gz
opam_archive 'upstream/conduit-async.1.0.3' ocaml-conduit-v1.0.3.tar.gz
opam_archive 'upstream/conduit-lwt-unix.1.0.3' ocaml-conduit-v1.0.3.tar.gz
opam_archive 'upstream/conduit-lwt.1.0.3' ocaml-conduit-v1.0.3.tar.gz
opam_archive 'upstream/conduit.1.0.3' ocaml-conduit-v1.0.3.tar.gz
opam_archive 'upstream/configurator.v0.10.0' configurator-v0.10.0.tar.gz
opam_archive 'upstream/core.v0.10.0' core-v0.10.0.tar.gz
opam_archive 'upstream/core_kernel.v0.10.0' core_kernel-v0.10.0.tar.gz
opam_archive 'upstream/cow.2.2.0' cow-2.2.0.tbz
opam_archive 'upstream/cppo.1.6.4' cppo-v1.6.4.tar.gz
opam_archive 'upstream/cppo_ocamlbuild.1.6.0' cppo-v1.6.0.tar.gz
opam_archive 'upstream/cpuid.0.1.1' cpuid-0.1.1.tbz
opam_archive 'upstream/cstruct-lwt.3.2.1' cstruct-3.2.1.tbz
opam_archive 'upstream/cstruct.3.2.1' cstruct-3.2.1.tbz
opam_archive 'upstream/ctypes.0.13.1' ocaml-ctypes-0.13.1.tar.gz
opam_archive 'upstream/depext.1.0.5' opam-depext-full-1.0.5.tbz
opam_archive 'upstream/duration.0.1.1' duration-0.1.1.tbz
opam_archive 'upstream/easy-format.1.3.1' easy-format-v1.3.1.tar.gz
opam_archive 'upstream/ezjsonm.0.5.0' ezjsonm-0.5.0.tbz
opam_archive 'upstream/fieldslib.v0.10.0' fieldslib-v0.10.0.tar.gz
opam_archive 'upstream/fmt.0.8.5' fmt-0.8.5.tbz
opam_archive 'upstream/hex.1.2.0' hex-1.2.0.tbz
opam_archive 'upstream/inotify.2.3' ocaml-inotify-v2.3.tar.gz
opam_archive 'upstream/integers.0.2.2' integers-0.2.2.tbz
opam_archive 'upstream/io-page-unix.2.0.1' io-page-2.0.1.tbz
opam_archive 'upstream/io-page.2.0.1' io-page-2.0.1.tbz
opam_archive 'upstream/ipaddr.2.8.0' ipaddr-2.8.0.tbz
opam_archive 'upstream/jane-street-headers.v0.10.0' jane-street-headers-v0.10.0.tar.gz
opam_archive 'upstream/jbuilder.1.0+beta19.1' jbuilder-1.0.beta19.1.tbz
opam_archive 'upstream/jsonm.1.0.1' jsonm-1.0.1.tbz
opam_archive 'upstream/logs.0.6.2' logs-0.6.2.tbz
opam_archive 'upstream/lwt.3.3.0' lwt-3.3.0.tar.gz
opam_archive 'upstream/lwt_log.1.0.0' lwt-3.2.0.tar.gz
opam_archive 'upstream/lwt_ssl.1.1.2' lwt_ssl-1.1.2.tar.gz
opam_archive 'upstream/magic-mime.1.0.1' magic-mime-1.0.1.tbz
opam_archive 'upstream/menhir.20170607' archive.tar.gz
opam_archive 'upstream/mirage-block-lwt.1.1.0' mirage-block-1.1.0.tbz
opam_archive 'upstream/mirage-block-unix.2.9.0' mirage-block-unix-2.9.0.tbz
opam_archive 'upstream/mirage-block.1.1.0' mirage-block-1.1.0.tbz
opam_archive 'upstream/mirage-channel-lwt.3.1.0' mirage-channel-3.1.0.tbz
opam_archive 'upstream/mirage-channel.3.1.0' mirage-channel-3.1.0.tbz
opam_archive 'upstream/mirage-clock-lwt.1.3.0' mirage-clock-1.3.0.tbz
opam_archive 'upstream/mirage-clock-unix.1.4.0' mirage-clock-1.4.0.tbz
opam_archive 'upstream/mirage-clock.1.3.0' mirage-clock-1.3.0.tbz
opam_archive 'upstream/mirage-console-lwt.2.3.5' mirage-console-2.3.5.tbz
opam_archive 'upstream/mirage-console.2.3.5' mirage-console-2.3.5.tbz
opam_archive 'upstream/mirage-device.1.1.0' mirage-device-1.1.0.tbz
opam_archive 'upstream/mirage-flow-lwt.1.4.0' mirage-flow-1.4.0.tbz
opam_archive 'upstream/mirage-flow.1.3.0' mirage-flow-1.3.0.tbz
opam_archive 'upstream/mirage-fs-lwt.1.1.1' mirage-fs-1.1.1.tbz
opam_archive 'upstream/mirage-fs.1.1.1' mirage-fs-1.1.1.tbz
opam_archive 'upstream/mirage-kv-lwt.1.1.0' mirage-kv-1.1.0.tbz
opam_archive 'upstream/mirage-kv.1.1.1' mirage-kv-1.1.1.tbz
opam_archive 'upstream/mirage-net-lwt.1.1.0' mirage-net-1.1.0.tbz
opam_archive 'upstream/mirage-net.1.1.1' mirage-net-1.1.1.tbz
opam_archive 'upstream/mirage-profile.0.7.0' mirage-profile-v0.7.0.tar.gz
opam_archive 'upstream/mirage-protocols-lwt.1.3.0' mirage-protocols-1.3.0.tbz
opam_archive 'upstream/mirage-protocols.1.3.0' mirage-protocols-1.3.0.tbz
opam_archive 'upstream/mirage-random.1.1.0' mirage-random-1.1.0.tbz
opam_archive 'upstream/mirage-stack-lwt.1.2.0' mirage-stack-1.2.0.tbz
opam_archive 'upstream/mirage-stack.1.2.0' mirage-stack-1.2.0.tbz
opam_archive 'upstream/mirage-time-lwt.1.1.0' mirage-time-1.1.0.tbz
opam_archive 'upstream/mirage-time.1.1.0' mirage-time-1.1.0.tbz
opam_archive 'upstream/mirage-types-lwt.3.0.7' mirage-3.0.7.tbz
opam_archive 'upstream/mirage-types.3.0.7' mirage-3.0.7.tbz
opam_archive 'upstream/mtime.1.1.0' mtime-1.1.0.tbz
opam_archive 'upstream/mustache.3.0.0.1' ocaml-mustache-v3.0.0.tar.gz
opam_archive 'upstream/nocrypto.0.5.4' nocrypto-0.5.4.tbz
opam_archive 'upstream/oasis.0.4.10' oasis-0.4.10.tar.gz
opam_archive 'upstream/ocaml-compiler-libs.v0.10.0' ocaml-compiler-libs-v0.10.0.tar.gz
opam_archive 'upstream/ocaml-migrate-parsetree.1.0.9' ocaml-migrate-parsetree-1.0.9.tbz
opam_archive 'upstream/ocamlbuild.0.12.0' ocamlbuild-0.12.0.tar.gz
opam_archive 'upstream/ocamlfind.1.7.3-1' findlib-1.7.3.tar.gz
opam_archive 'upstream/ocamlify.0.0.1' ocamlify-0.0.1.tar.gz
opam_archive 'upstream/ocamlmod.0.0.9' ocamlmod-0.0.9.tar.gz
opam_archive 'upstream/ocb-stubblr.0.1.1' ocb-stubblr-0.1.1.tbz
opam_archive 'upstream/ocplib-endian.1.0' ocplib-endian-1.0.tar.gz
opam_archive 'upstream/octavius.1.2.0' octavius-v1.2.0.tar.gz
opam_archive 'upstream/omd.1.3.1' omd-1.3.1.tar.gz
opam_archive 'upstream/ounit.2.0.7' ounit-2.0.7.tar.gz
opam_archive 'upstream/ppx_assert.v0.10.0' ppx_assert-v0.10.0.tar.gz
opam_archive 'upstream/ppx_ast.v0.10.0' ppx_ast-v0.10.0.tar.gz
opam_archive 'upstream/ppx_base.v0.10.0' ppx_base-v0.10.0.tar.gz
opam_archive 'upstream/ppx_bench.v0.10.0' ppx_bench-v0.10.0.tar.gz
opam_archive 'upstream/ppx_bin_prot.v0.10.0' ppx_bin_prot-v0.10.0.tar.gz
opam_archive 'upstream/ppx_compare.v0.10.0' ppx_compare-v0.10.0.tar.gz
opam_archive 'upstream/ppx_core.v0.10.0' ppx_core-v0.10.0.tar.gz
opam_archive 'upstream/ppx_cstruct.3.2.1' cstruct-3.2.1.tbz
opam_archive 'upstream/ppx_custom_printf.v0.10.0' ppx_custom_printf-v0.10.0.tar.gz
opam_archive 'upstream/ppx_derivers.1.0' ppx_derivers-1.0.tar.gz
opam_archive 'upstream/ppx_deriving.4.2.1' ppx_deriving-v4.2.1.tar.gz
opam_archive 'upstream/ppx_driver.v0.10.4' ppx_driver-v0.10.4.tar.gz
opam_archive 'upstream/ppx_enumerate.v0.10.0' ppx_enumerate-v0.10.0.tar.gz
opam_archive 'upstream/ppx_expect.v0.10.1' ppx_expect-v0.10.1.tar.gz
opam_archive 'upstream/ppx_fail.v0.10.0' ppx_fail-v0.10.0.tar.gz
opam_archive 'upstream/ppx_fields_conv.v0.10.0' ppx_fields_conv-v0.10.0.tar.gz
opam_archive 'upstream/ppx_hash.v0.10.0' ppx_hash-v0.10.0.tar.gz
opam_archive 'upstream/ppx_here.v0.10.0' ppx_here-v0.10.0.tar.gz
opam_archive 'upstream/ppx_inline_test.v0.10.1' ppx_inline_test-v0.10.1.tar.gz
opam_archive 'upstream/ppx_jane.v0.10.0' ppx_jane-v0.10.0.tar.gz
opam_archive 'upstream/ppx_js_style.v0.10.0' ppx_js_style-v0.10.0.tar.gz
opam_archive 'upstream/ppx_let.v0.10.0' ppx_let-v0.10.0.tar.gz
opam_archive 'upstream/ppx_metaquot.v0.10.0' ppx_metaquot-v0.10.0.tar.gz
opam_archive 'upstream/ppx_optcomp.v0.10.0' ppx_optcomp-v0.10.0.tar.gz
opam_archive 'upstream/ppx_optional.v0.10.0' ppx_optional-v0.10.0.tar.gz
opam_archive 'upstream/ppx_pipebang.v0.10.0' ppx_pipebang-v0.10.0.tar.gz
opam_archive 'upstream/ppx_sexp_conv.v0.10.0' ppx_sexp_conv-v0.10.0.tar.gz
opam_archive 'upstream/ppx_sexp_message.v0.10.0' ppx_sexp_message-v0.10.0.tar.gz
opam_archive 'upstream/ppx_sexp_value.v0.10.0' ppx_sexp_value-v0.10.0.tar.gz
opam_archive 'upstream/ppx_tools.5.0' ppx_tools-5.0+4.04.tar.gz
opam_archive 'upstream/ppx_tools_versioned.5.1' ppx_tools_versioned-5.1.tar.gz
opam_archive 'upstream/ppx_traverse.v0.10.0' ppx_traverse-v0.10.0.tar.gz
opam_archive 'upstream/ppx_traverse_builtins.v0.10.0' ppx_traverse_builtins-v0.10.0.tar.gz
opam_archive 'upstream/ppx_type_conv.v0.10.0' ppx_type_conv-v0.10.0.tar.gz
opam_archive 'upstream/ppx_typerep_conv.v0.10.0' ppx_typerep_conv-v0.10.0.tar.gz
opam_archive 'upstream/ppx_variants_conv.v0.10.0' ppx_variants_conv-v0.10.0.tar.gz
opam_archive 'upstream/protocol_version_header.v0.10.0' protocol_version_header-v0.10.0.tar.gz
opam_archive 'upstream/ptime.0.8.3' ptime-0.8.3.tbz
opam_archive 'upstream/re.1.7.3' re-1.7.3.tbz
opam_archive 'upstream/result.1.3' result-1.3.tbz
opam_archive 'upstream/rpc.3.2.0' ocaml-rpc-v3.2.0.tar.gz
opam_archive 'upstream/rresult.0.5.0' rresult-0.5.0.tbz
opam_archive 'upstream/sexplib.v0.10.0' sexplib-v0.10.0.tar.gz
opam_archive 'upstream/sha.1.10' ocaml-sha-v1.10.tar.gz
opam_archive 'upstream/shared-block-ring.2.4.0' shared-block-ring-v2.4.0.tar.gz
opam_archive 'upstream/spawn.v0.10.1' spawn-v0.10.1.tar.gz
opam_archive 'upstream/ssl.0.5.5' ocaml-ssl-0.5.5.tar.gz
opam_archive 'upstream/stdio.v0.10.0' stdio-v0.10.0.tar.gz
opam_archive 'upstream/stringext.1.5.0' stringext-1.5.0.tar.gz
opam_archive 'upstream/systemd.1.2' ocaml-systemd-1.2.tar.gz
opam_archive 'upstream/tar-unix.0.9.0' tar-0.9.0.tbz
opam_archive 'upstream/tar.0.9.0' tar-0.9.0.tbz
opam_archive 'upstream/topkg.0.9.1' topkg-0.9.1.tbz
opam_archive 'upstream/type_conv.113.00.02' type_conv-113.00.02.tar.gz
opam_archive 'upstream/typerep.v0.10.0' typerep-v0.10.0.tar.gz
opam_archive 'upstream/uchar.0.0.2' uchar-0.0.2.tbz
opam_archive 'upstream/unix-errno.0.5.2' ocaml-unix-errno-0.5.2.tar.gz
opam_archive 'upstream/uri.1.9.6' uri-1.9.6.tbz
opam_archive 'upstream/uuidm.0.9.6' uuidm-0.9.6.tbz
opam_archive 'upstream/uutf.1.0.1' uutf-1.0.1.tbz
opam_archive 'upstream/variantslib.v0.10.0' variantslib-v0.10.0.tar.gz
opam_archive 'upstream/vhd-format-lwt.0.9.2' ocaml-vhd-v0.9.2.tar.gz
opam_archive 'upstream/vhd-format.0.9.2' ocaml-vhd-v0.9.2.tar.gz
opam_archive 'upstream/x509.0.6.1' x509-0.6.1.tbz
opam_archive 'upstream/xen-gnt-unix.3.0.1' xen-gnt-3.0.1.tbz
opam_archive 'upstream/xen-gnt.3.0.1' xen-gnt-3.0.1.tbz
opam_archive 'upstream/xenstore.2.0.0' xenstore-2.0.0.tbz
opam_archive 'upstream/xenstore_transport.1.0.0' ocaml-xenstore-clients-v1.0.0.tar.gz
opam_archive 'upstream/xmlm.1.3.0' xmlm-1.3.0.tbz
opam_archive 'upstream/yojson.1.4.1' yojson-v1.4.1.tar.gz
opam_archive 'upstream/zarith.1.7' Zarith-release-1.7.tar.gz
opam_archive 'xs/cdrom.0.9.3' cdrom-v0.9.3.tar.gz
opam_archive 'xs/crc.2.0.0' ocaml-crc-2.0.0.tar.gz
opam_archive 'xs/dlm.0.3.0' dlm-0.3.0.tbz
opam_archive 'xs/ezxenstore.0.2.0' ezxenstore-v0.2.0.tar.gz
opam_archive 'xs/fd-send-recv.1.0.5' ocaml-fd-send-recv-v1.0.5.tar.gz
opam_archive 'xs/nbd-lwt-unix.4.0.0+beta1' nbd-v4.0.0+beta1.tar.gz
opam_archive 'xs/nbd.4.0.0+beta1' nbd-v4.0.0+beta1.tar.gz
opam_archive 'xs/netlink.0.3.1' ocaml-netlink-v0.3.1.tar.gz
opam_archive 'xs/opasswd.1.3.0' ocaml-opasswd-v1.3.0.tar.gz
opam_archive 'xs/qmp.0.14.0' ocaml-qmp-0.14.0.tar.gz
opam_archive 'xs/rrd.1.3.0' xcp-rrd-v1.3.0.tar.gz
opam_archive 'xs/stdext.4.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-backtrace.0.5' backtrace-v0.5.tar.gz
opam_archive 'xs/xapi-inventory.1.2.0' xcp-inventory-v1.2.0.tar.gz
opam_archive 'xs/xapi-stdext-base64.1.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-bigbuffer.1.1.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-date.1.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-deprecated.1.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-encodings.1.1.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-monadic.1.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-pervasives.1.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-range.1.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-std.1.1.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-threads.1.1.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-unix.1.1.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-stdext-zerocheck.1.0.0' stdext-v4.0.0.tar.gz
opam_archive 'xs/xapi-test-utils.1.1.0' xapi-test-utils-v1.1.0.tar.gz
opam_archive 'xs/xcp-inventory.1.2.0' xcp-inventory-v1.2.0.tar.gz
(cd build; opam-admin make)
find build/packages -type f -name 'url.off' -execdir mv '{}' url ';'

%install
mkdir -p %{buildroot}/usr/share/opam-repository
(cd build && rsync -avW  archives packages %{buildroot}/usr/share/opam-repository/)
chmod o+w -R %{buildroot}/usr/share/opam-repository

# create opam root
mkdir -p %{buildroot}/usr/lib/opamroot
chmod 777 %{buildroot}/usr/lib/opamroot


%files
/usr/share/opam-repository
/usr/lib/opamroot
%attr(777, root, wheel) /usr/lib/opamroot

%changelog
* Wed Aug 01 2018 Samuel Verschelde <stormi-xcp@ylix.fr> - 3.9.1-1.1.xcp
- Backport upstream fix to ocaml-vhd to fix large VDI import

* Tue Apr 24 2018 Christian Lindig <christian.lindig@citrix.com> - 3.9.1-1
- This file is auto-generated and the changelog currently does not
  reflect the changes.
